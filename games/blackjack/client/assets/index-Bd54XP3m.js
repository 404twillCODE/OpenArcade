(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))c(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const d of r.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&c(d)}).observe(document,{childList:!0,subtree:!0});function t(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function c(o){if(o.ep)return;o.ep=!0;const r=t(o);fetch(o.href,r)}})();const L="openarcade_blackjack_name",C="openarcade_blackjack_playerId",A=location.protocol==="https:"?"wss:":"ws:",B=`${A}//${location.host}/ws/blackjack`,i=e=>document.getElementById(e),H=i("join-screen"),w=i("game-screen"),l=i("name-input"),R=i("join-btn"),g=i("status-pill"),_=i("dealer-score"),v=i("dealer-cards"),E=i("players-area"),N=i("hit-btn"),x=i("stand-btn"),O=i("start-round-btn"),P=i("reset-btn"),m=i("result-banner");let a=null,u=null,s=null,h=null,b=!1;function y(e,n){g.className="status-pill "+(e||""),g.textContent=n}function j(){if(a&&a.readyState===WebSocket.OPEN)return;y("","Connectingâ€¦");const e=new WebSocket(B);e.onopen=()=>{y("connected","Connected"),h&&(clearTimeout(h),h=null),b&&f({type:"join",name:T(),playerId:u??void 0})},e.onclose=()=>{y("disconnected","Disconnected"),a=null,b&&(y("reconnecting","Reconnectingâ€¦"),h=setTimeout(j,2e3))},e.onerror=()=>{y("disconnected","Error")},e.onmessage=n=>{let t;try{t=JSON.parse(n.data)}catch{return}if(t.type==="state"&&t.state)s=t.state,Y();else if(t.type==="toast"&&t.message)S(t.message);else if(t.type==="error"&&t.message)S(t.message,"error");else if(t.type==="you"&&t.playerId){u=t.playerId;try{localStorage.setItem(C,u)}catch{}}},a=e}function f(e){a&&a.readyState===WebSocket.OPEN&&a.send(JSON.stringify(e))}function T(){return(l==null?void 0:l.value.trim())||"Player"}function S(e,n){const t=document.createElement("div");t.className="toast "+(n||""),t.setAttribute("role","alert"),t.textContent=e,t.style.cssText="position:fixed;bottom:24px;left:50%;transform:translateX(-50%);padding:12px 20px;background:var(--surface-elevated);border:1px solid var(--border);border-radius:8px;font-size:14px;z-index:1000;animation:fadeIn 0.2s ease;",document.body.appendChild(t),setTimeout(()=>t.remove(),3e3)}function I(e){const n=document.createElement("div");if(n.className="card",e.suit==="back"||e.value==="hidden")return n.classList.add("back"),n.textContent="ğŸ‚ ",n;(e.suit==="hearts"||e.suit==="diamonds")&&n.classList.add("red");const c=e.value==="ace"?"A":e.value==="jack"?"J":e.value==="queen"?"Q":e.value==="king"?"K":e.value;return n.textContent=c,n}function M(){var e,n;if(s!=null&&s.players){E.innerHTML="";for(const t of s.players){const c=document.createElement("div");c.className="player-seat",c.dataset.playerId=t.id,s.currentTurn===t.id&&c.classList.add("turn"),t.connected||c.classList.add("disconnected");const o=document.createElement("div");if(o.className="name",o.textContent=t.name||"â€”",t.isHost){const p=document.createElement("span");p.className="host-badge",p.textContent="Host",o.appendChild(p)}c.appendChild(o);const r=document.createElement("div");r.className="score",r.textContent=(e=t.hand)!=null&&e.length?"Score: "+t.score:"",c.appendChild(r);const d=document.createElement("div");if(d.className="cards",(n=t.hand)!=null&&n.length)for(const p of t.hand)d.appendChild(I(p));c.appendChild(d),E.appendChild(c)}}}function W(){var e;if(s&&(_.textContent=s.dealerScore?"Dealer: "+s.dealerScore:"",v.innerHTML="",(e=s.dealerHand)!=null&&e.length))for(const n of s.dealerHand)v.appendChild(I(n))}function D(){var o;const n=(s==null?void 0:s.phase)==="playing"&&s.currentTurn===u&&(a==null?void 0:a.readyState)===WebSocket.OPEN;N.disabled=!n,x.disabled=!n;const t=((o=s==null?void 0:s.players)==null?void 0:o.some(r=>r.id===u&&r.isHost))??!1,c=(s==null?void 0:s.phase)==="lobby";O.disabled=!(t&&c&&(a==null?void 0:a.readyState)===WebSocket.OPEN),P.disabled=!(t&&(a==null?void 0:a.readyState)===WebSocket.OPEN)}function J(){if(!s||s.phase!=="results"||!s.results||!u){m.classList.add("hidden");return}const e=s.results[u];if(!e){m.classList.add("hidden");return}m.classList.remove("hidden"),m.className="result-banner "+(e==="win"||e==="blackjack"?"win":e==="lose"||e==="bust"?"lose":"push");const n=e==="blackjack"?"Blackjack!":e==="win"?"You win":e==="lose"||e==="bust"?"You lose":"Push";m.textContent=n}function Y(){W(),M(),D(),J()}function k(){const e=T();try{localStorage.setItem(L,e)}catch{}let n=null;try{n=localStorage.getItem(C)}catch{}f({type:"join",name:e,playerId:n??void 0}),b=!0,H.classList.add("hidden"),w.classList.remove("hidden")}function $(){try{const e=localStorage.getItem(L);e&&l&&(l.value=e)}catch{}R.addEventListener("click",k),l==null||l.addEventListener("keydown",e=>{e.key==="Enter"&&k()}),N.addEventListener("click",()=>f({type:"action",action:"hit"})),x.addEventListener("click",()=>f({type:"action",action:"stand"})),O.addEventListener("click",()=>f({type:"startRound"})),P.addEventListener("click",()=>f({type:"reset"})),j()}$();
